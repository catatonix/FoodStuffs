<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../paper-input/paper-input-behavior.html"><link rel="import" href="../paper-input/paper-input-container.html"><link rel="import" href="../iron-input/iron-input.html"><link rel="import" href="../paper-input/paper-input-error.html"><link rel="import" href="../iron-form-element-behavior/iron-form-element-behavior.html"><link rel="import" href="../iron-validatable-behavior/iron-validatable-behavior.html"><link rel="import" href="../paper-input/paper-input.html"><link rel="import" href="../moment-element/moment-import.html"></head><body><dom-module id="titanium-date-input"><template><style>:host{display:block;}paper-input{width:100%;--paper-input-container:{padding-bottom:0;};}::slotted(*){color:#737373;}paper-input[focused] ::slotted(*){--iron-icon-fill-color:var(--primary-color);color:var(--primary-color);}paper-input[error] ::slotted(*){--iron-icon-fill-color:var(--error-color);color:var(--error-color);}paper-input[disabled] ::slotted(*){--iron-icon-fill-color:#B6B6B6;color:#B6B6B6;}</style><paper-input type="text" id="input" always-float-label="" placeholder="[[placeholder]]" label="[[label]]" error-message="[[errorMessage]]" required="[[required]]" allowed-pattern="[0-9\/]" maxlength="10" value="{{value}}" disabled$="[[disabled]]" focused$="{{focused}}" validator="[[validator]]" invalid="{{error}}" error$="[[error]]" date-pattern="[[datePattern]]"><slot name="prefix" slot="prefix"></slot><slot name="suffix" slot="suffix"></slot></paper-input></template><script>'use strict';class TitaniumDateInput extends Polymer.Element{static get is(){return'titanium-date-input'}static get properties(){return{label:{type:String},value:{type:String,notify:!0,observer:'_valueChanged'},autoValidate:{type:Boolean,notify:!0},required:{type:Boolean,notify:!0},disabled:{type:Boolean,value:!1},datePattern:{type:String,value:'MM/DD/YYYY'},placeholder:{type:String,value:'mm/dd/yyyy'},errorMessage:{type:String},focused:{type:Boolean,notify:!0},validator:{type:String},invalid:{type:Boolean,reflectToAttribute:!0,notify:!0}}}static get observers(){return['_onFocusedChanged(focused)']}connectedCallback(){super.connectedCallback();var a='';a=this.datePattern.replace(/\s/g,'\\s'),a=a.replace(/M/gi,'d'),a=a.replace(/D/gi,'\\d'),a=a.replace(/Y/gi,'\\d'),a=a.replace(/\+/g,'\\+'),this.$.input.pattern=a}_valueChanged(a,b){if('undefined'===typeof b||a===b)return;if('object'===typeof a&&(a=moment(a,'MM/DD/YYYY').format('MM/DD/YYYY')),!a||a===b)return;let c=a?a.toString():'',d=this.$.input.shadowRoot.querySelector('#nativeInput'),e=d.selectionStart,f=c.substr(0,e).split('/').length-1;c=c.replace(/\//g,'');let g=c.length<=this.datePattern.replace(/\//g,'').length,h='',j=0,k=0;for(let d=0;d<c.length;d++)j=this.datePattern.indexOf('/',j),g&&d==j-k&&(h+='/',j++,k++),h+=c[d];let i=h.substr(0,e).split('/').length-1;this.updateValueAndPreserveCaret(h.trim()),setTimeout(()=>{d.selectionStart=d.selectionEnd=e+(i-f)},0),this.validate()}updateValueAndPreserveCaret(a){let b=this.$.input.shadowRoot.querySelector('#nativeInput');try{let c=b.selectionStart;this.value=a,b.selectionStart=c,b.selectionEnd=c}catch(b){this.value=a}}_onFocusedChanged(a){a||this.validate()}validate(){let a=this.$.input.validate();return a}}customElements.define(TitaniumDateInput.is,TitaniumDateInput);</script></dom-module></body></html>